<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiger Sighting Prediction</title>
</head>
<body>
    <h1>Tiger Sighting Prediction</h1>
    
    <label for="date">Date (YYYY-MM-DD): </label>
    <input type="date" id="date" name="date"><br><br>
    
    <label for="national_park">National Park: </label>
    <select id="national_park" name="national_park">
        <option value="">Select a National Park</option>
    </select><br><br>
    
    <button onclick="predict()">Predict</button>
    
    <h2>Prediction Result:</h2>
    <p id="prediction_result"></p>

    <script>
        const API_BASE_URL = 'https://jaik45.pythonanywhere.com/;

        // Fetch the list of national parks when the page loads
        window.onload = function() {
            fetch('https://jaik45.pythonanywhere.com/getData')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    let parkSelect = document.getElementById("national_park");
                    data.forEach(function(park) {
                        let option = document.createElement("option");
                        option.value = park;
                        option.textContent = park;
                        parkSelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error fetching national parks:', error);
                    document.getElementById("prediction_result").textContent = "Error loading park options.";
                });
        };

        // Function to handle the prediction request
        function predict() {
            const date = document.getElementById("date").value;
            const nationalPark = document.getElementById("national_park").value;

            if (!date || !nationalPark) {
                document.getElementById("prediction_result").textContent = "Please select a date and national park.";
                return;
            }

            const requestData = {
                date: date,
                national_park: nationalPark
            };

            fetch('https://jaik45.pythonanywhere.com/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            })
            .then(response => response.json())
            .then(data => {
                const resultContainer = document.getElementById("prediction_result");
                if (data.error) {
                    resultContainer.style.color = 'red';
                    resultContainer.textContent = 'Error: ' + data.error;
                } else {
                    resultContainer.style.color = '#5a9f52';
                    const topGates = data.top_gates.join(', ');
                    resultContainer.textContent = 'Top gates for tiger sightings: ' + topGates;
                }
            })
            .catch(error => {
                console.error('Error fetching prediction:', error);
                document.getElementById("prediction_result").textContent = 'Error fetching prediction.';
            });
        }
    </script>
</body>
</html>
